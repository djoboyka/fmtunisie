<!doctype html>
<html lang="fr">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <!-- Performance Optimization: Preconnect to external domains -->
  <link rel="preconnect" href="https://www.googletagmanager.com" crossorigin>
  <link rel="preconnect" href="https://app.usercentrics.eu" crossorigin>
  <link rel="preconnect" href="https://pagead2.googlesyndication.com" crossorigin>
  <link rel="dns-prefetch" href="//www.googletagmanager.com">
  <link rel="dns-prefetch" href="//app.usercentrics.eu">
  
  <!-- Critical CSS - Above the fold styles -->
  <style>
    /* Critical path CSS for immediate rendering */
    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
    }
    
    .min-h-screen {
      min-height: 100vh;
    }
    
    .flex {
      display: flex;
    }
    
    .flex-col {
      flex-direction: column;
    }
    
    .flex-grow {
      flex-grow: 1;
    }
    
    /* Loading spinner for lazy loaded content */
    .loading-spinner {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid #f3f3f3;
      border-top: 3px solid #3498db;
      border-radius: 50%;
      animation: spin 2s linear infinite;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    /* Prevent FOUC (Flash of Unstyled Content) */
    #root {
      opacity: 0;
      transition: opacity 0.3s ease-in-out;
    }
    
    #root.loaded {
      opacity: 1;
    }
  </style>
  
  <!-- SEO Meta Tags -->
  <title>FM Tunisie Voyage - Découvrez la Tunisie Authentique | Guide de Voyage Complet</title>
  <meta name="description" content="Découvrez la Tunisie authentique avec FM Tunisie Voyage. Guide complet des destinations, conseils voyage, culture tunisienne, gastronomique et experiences uniques." />
  <meta name="keywords" content="Tunisie, voyage Tunisie, guide voyage, destinations Tunisie, culture tunisienne, gastronomie Tunisie, FM Tunisie Voyage" />
  <meta name="author" content="FM Tunisie Voyage" />
  <meta name="robots" content="index, follow" />
  
  <!-- Google Search Console Verification -->
  <meta name="google-site-verification" content="_KiAOIvUAT9QpRRW_SQV_BLcOoq3uZ3cFqyA22NVG1c" />
  <meta name="google-site-verification" content="6CsMawLtzkJ9cvfqIV76BmJZ0IujzCZ9yqXC8ZXZQtA" />
  
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://www.fmtunisie.com/" />
  <meta property="og:title" content="FM Tunisie Voyage - Découvrez la Tunisie Authentique" />
  <meta property="og:description" content="Guide complet pour découvrir la Tunisie authentique : destinations, culture, gastronomie et conseils de voyage." />
  <meta property="og:image" content="https://www.fmtunisie.com/images/sidi_bou_said_2.jpg" />

  <!-- Twitter -->
  <meta property="twitter:card" content="summary_large_image" />
  <meta property="twitter:url" content="https://www.fmtunisie.com/" />
  <meta property="twitter:title" content="FM Tunisie Voyage - Découvrez la Tunisie Authentique" />
  <meta property="twitter:description" content="Guide complet pour découvrir la Tunisie authentique : destinations, culture, gastronomie et conseils de voyage." />
  <meta property="twitter:image" content="https://www.fmtunisie.com/images/sidi_bou_said_2.jpg" />

  <!-- Theme -->
  <meta name="theme-color" content="#1e40af" />
  
  <!-- Canonical URL (will be overridden by individual pages) -->
  <link rel="canonical" href="https://www.fmtunisie.com" />
  
  <!-- Core Web Vitals Optimization -->
  <!-- Optimize LCP by preloading critical resources -->
  <link rel="preload" href="/logo.webp" as="image" fetchpriority="high">
  <link rel="preload" href="/images/hero_landscape.webp" as="image" fetchpriority="high">
  
  <!-- Resource hints for better loading -->
  <link rel="prefetch" href="/destinations">
  <link rel="prefetch" href="/blog">
  <link rel="prefetch" href="/guide-voyage">
  
  <!-- Critical rendering path optimization -->
  <script>
    // Optimize for Core Web Vitals
    window.addEventListener('load', function() {
      // Defer non-critical scripts
      setTimeout(function() {
        // Initialize performance monitoring
        if ('PerformanceObserver' in window) {
          const observer = new PerformanceObserver((list) => {
            for (const entry of list.getEntries()) {
              if (entry.entryType === 'largest-contentful-paint') {
                console.log('LCP:', entry.startTime);
              }
              if (entry.entryType === 'layout-shift' && !entry.hadRecentInput) {
                console.log('CLS:', entry.value);
              }
            }
          });
          observer.observe({entryTypes: ['largest-contentful-paint', 'layout-shift']});
        }
      }, 100);
    });
  </script>

  <!-- Favicon with proper sizing -->
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="64x64" href="/favicon-64x64.png" />
  <link rel="apple-touch-icon" href="/logo.webp" />
  
  <!-- Service Worker Registration for caching -->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', function() {
        navigator.serviceWorker.register('/sw.js').then(function(registration) {
          console.log('SW registered: ', registration);
        }).catch(function(registrationError) {
          console.log('SW registration failed: ', registrationError);
        });
      });
    }
  </script>
  
  <!-- Usercentrics Consent Management Platform -->
  <script id="usercentrics-cmp" src="https://app.usercentrics.eu/browser-ui/latest/loader.js" data-settings-id="ssOwkXUHwqRiGc" async></script>
  
  <!-- Google Consent Mode & Analytics (Loaded after Usercentrics CMP) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-ZK3C74LD29"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    // Set default consent mode to denied (GDPR compliance)
    gtag('consent', 'default', {
      'ad_storage': 'denied',
      'analytics_storage': 'denied',
      'functionality_storage': 'granted',
      'security_storage': 'granted',
      'personalization_storage': 'denied'
    });

    // Configure Google Analytics
    gtag('config', 'G-ZK3C74LD29');
  </script>
  
  <!-- Google Tag Manager with Consent Mode -->
  <script>
    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-5P4SMSSM');
  </script>
  
  <!-- Usercentrics-GTM Integration -->
  <script>
    // Update Google Consent Mode when Usercentrics consent changes
    window.addEventListener('uc-custom-consent-changed', function(event) {
      const consentData = event.detail;
      
      if (consentData) {
        // Convert Usercentrics consent to Google Consent Mode
        gtag('consent', 'update', {
          'ad_storage': consentData.ads ? 'granted' : 'denied',
          'analytics_storage': consentData.analytics ? 'granted' : 'denied',
          'personalization_storage': consentData.personalization ? 'granted' : 'denied'
        });
      }
    });
    
    // Also update on CMP load completion
    window.addEventListener('uc-cmp-ready', function() {
      if (window.UC_UI) {
        // Get initial consent status
        const consentData = window.UC_UI.getConsentData();
        if (consentData) {
          gtag('consent', 'update', {
            'ad_storage': consentData.ads ? 'granted' : 'denied',
            'analytics_storage': consentData.analytics ? 'granted' : 'denied',
            'personalization_storage': consentData.personalization ? 'granted' : 'denied'
          });
        }
      }
    });
  </script>
  
  <!-- Google AdSense for Ads (GDPR Compliant) -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2795912142767513"
     crossorigin="anonymous"></script>
  
  <!-- Enhanced AdSense Integration with Consent Mode -->
  <script>
    // Enhanced consent update for AdSense
    function updateAdSenseConsent(consentData) {
      if (consentData) {
        // Only load AdSense if ad consent is granted
        if (consentData.ads) {
          gtag('consent', 'update', {
            'ad_storage': 'granted'
          });
          
          // Ensure AdSense script is properly initialized
          if (typeof adsbygoogle !== 'undefined') {
            (adsbygoogle = window.adsbygoogle || []).push({});
          }
        } else {
          gtag('consent', 'update', {
            'ad_storage': 'denied'
          });
        }
      }
    }
    
    // Update AdSense consent on Usercentrics changes
    window.addEventListener('uc-custom-consent-changed', function(event) {
      const consentData = event.detail;
      updateAdSenseConsent(consentData);
    });
    
    // Update AdSense consent on CMP load
    window.addEventListener('uc-cmp-ready', function() {
      if (window.UC_UI) {
        const consentData = window.UC_UI.getConsentData();
        updateAdSenseConsent(consentData);
      }
    });
  </script>
</head>

<body>
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5P4SMSSM"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
  <div id="root"></div>
  <script type="module" src="/src/main.tsx"></script>
  
  <!-- Performance: Initialize content visibility after React loads -->
  <script>
    // Show content after React initializes to prevent FOUC
    window.addEventListener('load', function() {
      setTimeout(function() {
        const root = document.getElementById('root');
        if (root) {
          root.classList.add('loaded');
        }
      }, 100);
    });
  </script>
</body>

</html>